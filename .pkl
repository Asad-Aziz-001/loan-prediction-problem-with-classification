import pandas as pd
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import LabelEncoder
import joblib

# Load data
df = pd.read_csv("train_u6lujuX_CVtuZ9i.csv")
df.dropna(inplace=True)

# Encode categorical features
le = LabelEncoder()
for col in ['Gender', 'Married', 'Education', 'Self_Employed', 'Property_Area', 'Dependents']:
    df[col] = le.fit_transform(df[col])
df['Loan_Status'] = df['Loan_Status'].map({'Y': 1, 'N': 0})

# Prepare inputs and outputs
X = df.drop(columns=['Loan_ID', 'Loan_Status'])
y = df['Loan_Status']

# Train the model
model = RandomForestClassifier(random_state=42)
model.fit(X, y)

# Export model
joblib.dump(model, "loan_approval_model.pkl")
print("âœ… Model saved as 'loan_approval_model.pkl'")
